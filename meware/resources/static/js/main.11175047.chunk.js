(window["webpackJsonpmember-table-widget"]=window["webpackJsonpmember-table-widget"]||[]).push([[0],{113:function(e,t,a){"use strict";a.r(t);var r=a(49),n=a(50),i=a(57),o=a(40),c=a(51),l=a(84),s=a(19),u=a(0),d=a.n(u),m=a(7),f=a.n(m),p=a(69),b=a.n(p),h=a(162),v=a(164),y=a(11),O=d.a.createContext(null);var E=a(32),g=a.n(E),j=a(45),k=a(27),w=a(24),P=a(160),F=a(5),C=a(80),D=a.n(C),S=a(4),N=a.n(S),x=(N.a.shape({initialized:N.a.bool,authenticated:N.a.bool}),function(e){var t=e.children,a=e.keycloak;return a.initialized&&a.authenticated?t:null}),R=function(e){var t=e.children,a=e.keycloak;return a.initialized&&a.authenticated?null:t},I=a(151),A=a(153),U=a(161),z=a(145),T=a(170),L=a(166),W=a(165),H=a(152),M=a(75),q=a.n(M),K=(N.a.shape({field:N.a.string,operator:N.a.string,value:N.a.string}),a(21)),_=["equals","in","specified","unspecified"],J=["contains"],V=[{value:"greaterThan",title:">"},{value:"lessThan",title:"<"},{value:"greaterOrEqualThan",title:">="},{value:"lessOrEqualThan",title:"<="}],B=["name","surname"],G=[],Q=["age"],X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.length?e.filter((function(e){return e.field&&e.operator})).reduce((function(e,t){switch(t.operator){case"specified":return[].concat(Object(K.a)(e),["".concat(encodeURIComponent("".concat(t.field,".specified")),"=true")]);case"unspecified":return[].concat(Object(K.a)(e),["".concat(encodeURIComponent("".concat(t.field,".specified")),"=false")])}return[].concat(Object(K.a)(e),["".concat(encodeURIComponent("".concat(t.field,".").concat(t.operator)),"=").concat(encodeURIComponent(t.value))])}),[]).join("&"):""},Y=Object(F.a)((function(){return{formControl:{minWidth:120,width:"90%"},icon:{color:"rgba(0, 0, 0, 0.54)"}}}),{withTheme:!0})(Object(w.b)()((function(e){var t,a=e.filter,r=e.t,n=e.update,i=e.remove,o=e.filterId,c=e.classes,l=(t=a.field,[].concat(_,Object(K.a)(B.includes(t)?J:[]),Object(K.a)(G.includes(t)?V:[]),Object(K.a)(Q.includes(t)?V:[]))),u=function(e){n(o,Object(s.a)({},e.target.name,e.target.value))};return d.a.createElement(z.a,{container:!0},d.a.createElement(z.a,{item:!0,xs:5},d.a.createElement(L.a,{className:c.formControl},d.a.createElement(W.a,{id:"".concat(o,"-field-label")},r("filter.value")),d.a.createElement(U.a,{native:!0,labelId:"".concat(o,"-field-label"),id:"".concat(o,"-field"),name:"field",value:a.field,onChange:u},d.a.createElement("option",{value:""}),d.a.createElement("option",{value:"name"},r("entities.member.name")),d.a.createElement("option",{value:"surname"},r("entities.member.surname")),d.a.createElement("option",{value:"age"},r("entities.member.age"))))),d.a.createElement(z.a,{item:!0,xs:3},!!a.field&&d.a.createElement(L.a,{className:c.formControl},d.a.createElement(W.a,{id:"".concat(o,"-operator-label")},r("filter.operator")),d.a.createElement(U.a,{native:!0,labelId:"".concat(o,"-operator-label"),id:"".concat(o,"-operator"),name:"operator",value:a.operator,onChange:u},d.a.createElement("option",{value:""}),l.map((function(e){return"string"!==typeof e?d.a.createElement("option",{key:e.value,value:e.value},e.title):d.a.createElement("option",{key:e,value:e},r("filters.operators.".concat(e)))}))))),d.a.createElement(z.a,{item:!0,xs:3},!!a.operator&&!["specified","unspecified"].includes(a.operator)&&d.a.createElement(L.a,{className:c.formControl},d.a.createElement(T.a,{disabled:!a.field,id:"standard-required",name:"value",value:a.value,onChange:u,margin:"normal"}))),d.a.createElement(z.a,{item:!0,xs:1},d.a.createElement(H.a,{"aria-label":"Remove filter",className:c.icon,onClick:function(){i(o)}},d.a.createElement(q.a,null))))}))),Z=function(e){var t=e.classes,a=e.filters,r=e.applyFilter,n=e.update,i=e.remove,o=e.clear,c=e.add,l=e.t,s=a.length>0;return d.a.createElement(I.a,{className:t.root},d.a.createElement(A.a,{variant:"contained",className:t.button,onClick:c},l("filters.addFilter")),s&&d.a.createElement(A.a,{className:t.button,onClick:o},l("filters.clearFilters")),a.map((function(e,t){var a="".concat(e.field).concat(e.operator).concat(t);return d.a.createElement(Y,{key:a,update:n,remove:i,filterId:t,filter:e})})),s&&d.a.createElement(A.a,{variant:"contained",color:"primary",className:t.button,onClick:r},l("filters.filter")))};Z.defaultProps={applyFilter:function(){},add:function(){},update:function(){},remove:function(){},clear:function(){}};var $=Object(F.a)({root:{flexGrow:1,padding:"5px"},paper:{padding:"5px",textAlign:"center",height:"30px"},icon:{padding:"5px",color:"#555555","&:hover":{color:"#000000"}},button:{margin:"5px"}})(Object(w.b)()(Z)),ee=a(156),te=a(158),ae=a(155),re=a(154),ne=a(157),ie=(N.a.shape({id:N.a.number,name:N.a.string,surname:N.a.string,age:N.a.number}),function(e){var t=e.items,a=e.onSelect,r=e.classes,n=e.t,i=t.map((function(e){return d.a.createElement(re.a,{hover:!0,className:r.root,key:e.id,onClick:function(){return a(e)}},d.a.createElement(ae.a,null,d.a.createElement("span",null,e.name)),d.a.createElement(ae.a,null,d.a.createElement("span",null,e.surname)),d.a.createElement(ae.a,null,d.a.createElement("span",null,e.age)))}));return t.length?d.a.createElement(ee.a,null,d.a.createElement(ne.a,null,d.a.createElement(re.a,null,d.a.createElement(ae.a,null,d.a.createElement("span",null,n("entities.member.name"))),d.a.createElement(ae.a,null,d.a.createElement("span",null,n("entities.member.surname"))),d.a.createElement(ae.a,null,d.a.createElement("span",null,n("entities.member.age"))))),d.a.createElement(te.a,null,i)):n("entities.member.noItems")});ie.defaultProps={onSelect:function(){}};var oe=Object(F.a)({root:{cursor:"pointer"}})(Object(w.b)()(ie)),ce=a(3),le=a(167),se=a(168),ue=a(159),de=a(77),me=a.n(de),fe=a(78),pe=a.n(fe),be=a(76),he=a.n(be),ve=a(79),ye=a.n(ve),Oe={success:he.a,error:me.a,info:pe.a},Ee={success:3e3,error:null,info:5e3},ge=function e(t){var a=t.className,r=t.classes,n=t.status,i=t.message,o=t.onClose,c=!!i,l=n||e.INFO,s=Oe[l],u=Ee[l],m=d.a.createElement("span",{className:r.message},d.a.createElement(s,{className:Object(ce.a)(r.icon,r.iconStatus)}),i);return d.a.createElement(le.a,{open:c,onClose:o,autoHideDuration:u},d.a.createElement(se.a,{className:Object(ce.a)(r[l],a),message:m,action:[d.a.createElement(H.a,{key:"close","aria-label":"close",color:"inherit",onClick:o},d.a.createElement(ye.a,{className:r.icon}))]}))};ge.SUCCESS="success",ge.ERROR="error",ge.INFO="info",ge.defaultProps={message:null,status:null,className:"",onClose:function(){}};var je=Object(F.a)((function(e){return{message:{display:"flex",alignItems:"center"},icon:{fontSize:20},iconStatus:{opacity:.9,marginRight:e.spacing(1)},success:{backgroundColor:ue.a[600]},error:{backgroundColor:e.palette.error.dark},info:{backgroundColor:e.palette.primary.main}}}),{withTheme:!0})(ge),ke=Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_DOMAIN;function we(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Pe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?we(Object(a),!0).forEach((function(t){Object(s.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):we(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Fe=function(){var e=Object(j.a)(g.a.mark((function e(t,a){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,a);case 2:return r=e.sent,e.abrupt("return",r.status>=200&&r.status<300?r.json():Promise.reject(new Error(r.statusText||r.status)));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Ce=function(){var e=Object(j.a)(g.a.mark((function e(t){var a,r,n,i,o,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.filters,r=X(void 0===a?[]:a),n="".concat(ke,"/members").concat(r?"?".concat(r):""),i=window&&window.entando&&window.entando.keycloak&&window.entando.keycloak.authenticated?window.entando.keycloak.token:"",o={headers:new Headers({Authorization:"Bearer ".concat(i),"Content-Type":"application/json"})},c=Pe({},o,{method:"GET"}),e.abrupt("return",Fe(n,c));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),De={formUpdate:"member.form.update",formCreate:"member.form.create",formDelete:"member.form.delete"},Se={select:"member.table.select",add:"member.table.add",error:"member.table.error"};function Ne(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function xe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(a),!0).forEach((function(t){Object(s.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ne(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Re={filters:[],items:[],errorMessage:null,errorStatus:null,loading:!1},Ie=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(o.a)(t).call(this,e))).state=Re,a.handleError=a.handleError.bind(Object(k.a)(a)),a.closeNotification=a.closeNotification.bind(Object(k.a)(a)),a.fetchData=a.fetchData.bind(Object(k.a)(a)),a.updateFilter=a.updateFilter.bind(Object(k.a)(a)),a.addFilter=a.addFilter.bind(Object(k.a)(a)),a.removeFilter=a.removeFilter.bind(Object(k.a)(a)),a.clearFilters=a.clearFilters.bind(Object(k.a)(a)),a}return Object(c.a)(t,e),Object(n.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.keycloak;e.initialized&&e.authenticated&&this.fetchData()}},{key:"componentDidUpdate",value:function(e){var t=this.props.keycloak,a=t.initialized&&t.authenticated,r=e.keycloak.authenticated!==a;a&&r&&this.fetchData()}},{key:"dispatch",value:function(e){this.setState((function(t){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"addFilter":return xe({},e,{filters:[].concat(Object(K.a)(e.filters),[{field:"",operator:"",value:""}])});case"updateFilter":return xe({},e,{filters:e.filters.map((function(e,a){return a===t.payload.filterId?xe({},e,{},t.payload.values):e}))});case"deleteFilter":return xe({},e,{filters:e.filters.filter((function(e,a){return a!==t.payload.filterId}))});case"clearFilters":return xe({},e,{filters:Re.filters});case"readAll":return xe({},e,{items:t.payload});case"error":return xe({},e,{errorMessage:t.payload.message,errorStatus:t.payload.status});case"clearErrors":return xe({},e,{errorMessage:null,errorStatus:null});case"create":case De.formCreate:return xe({},e,{items:[].concat(Object(K.a)(e.items),[t.payload])});case"update":case De.formUpdate:var a=e.items.findIndex((function(e){return e.id===t.payload.id})),r=Object(K.a)(e.items);return r[a]=t.payload,xe({},e,{items:r});case"delete":case De.formDelete:return xe({},e,{items:e.items.filter((function(e){return e.id!==t.payload.id}))});default:return e}}(t,e)}))}},{key:"fetchData",value:function(){var e=Object(j.a)(g.a.mark((function e(){var t,a,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state.filters,a=this.props.keycloak,!(a.initialized&&a.authenticated)){e.next=14;break}return e.prev=4,e.next=7,Ce({filters:t});case 7:r=e.sent,this.dispatch({type:"readAll",payload:r}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),this.handleError(e.t0);case 14:case"end":return e.stop()}}),e,this,[[4,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"updateFilter",value:function(e,t){this.dispatch({type:"updateFilter",payload:{values:t,filterId:e}})}},{key:"addFilter",value:function(){this.dispatch({type:"addFilter"})}},{key:"removeFilter",value:function(e){this.dispatch({type:"deleteFilter",payload:{filterId:e}})}},{key:"clearFilters",value:function(){this.dispatch({type:"clearFilters"}),this.fetchData()}},{key:"closeNotification",value:function(){this.dispatch({type:"clearErrors"})}},{key:"handleError",value:function(e){var t=this.props,a=t.onError,r=t.t;a(e),this.dispatch({type:"error",payload:{message:r("member.error.dataLoading"),status:je.ERROR}})}},{key:"render",value:function(){var e=this.state,t=e.items,a=e.errorMessage,r=e.errorStatus,n=e.filters,i=this.props,o=i.classes,c=i.onSelect,l=i.onAdd,s=i.t,u=i.keycloak;return d.a.createElement(d.a.Fragment,null,d.a.createElement(R,{keycloak:u},s("common.notAuthenticated")),d.a.createElement(x,{keycloak:u},d.a.createElement(P.a,{color:"primary","aria-label":"add",className:o.fab,onClick:l},d.a.createElement(D.a,null)),d.a.createElement($,{applyFilter:this.fetchData,add:this.addFilter,update:this.updateFilter,remove:this.removeFilter,clear:this.clearFilters,filters:n}),d.a.createElement(oe,{items:t,onSelect:c})),d.a.createElement(je,{status:r,message:a,onClose:this.closeNotification}))}}]),t}(u.Component);Ie.defaultProps={onAdd:function(){},onError:function(){},onSelect:function(){}};var Ae,Ue=(Ae=Object(F.a)({fab:{float:"right"}})(Object(w.b)(void 0,{withRef:!0})(Ie)),function(e){return d.a.createElement(O.Consumer,null,(function(t){return d.a.createElement(Ae,Object.assign({},e,{keycloak:t}))}))}),ze=a(60),Te={en:a(83)};function Le(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}var We=Object.keys(Te).reduce((function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(a),!0).forEach((function(t){Object(s.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Le(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,Object(s.a)({},t,Object(s.a)({},"translation",Te[t])))}),{}),He=(ze.a.t,function(e){!function(e,t){ze.a.use(w.a).init({defaultNs:"translation",interpolation:{escapeValue:!1},resources:We,lng:e||t,fallbackLng:t,react:{useSuspense:!1}})}(e,"en")}),Me=function(e){return function(t){return function(e,t){var a=new CustomEvent(e,{detail:{payload:t}});window.dispatchEvent(a)}(e,t)}};function qe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ke(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(a),!0).forEach((function(t){Object(s.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):qe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _e=function(){return window&&window.entando&&window.entando.keycloak&&Ke({},window.entando.keycloak,{initialized:!0})||{initialized:!1}},Je={hidden:"hidden",locale:"locale",disableDefaultEventHandler:"disable-default-event-handler"},Ve=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(c)))).keycloak=_e(),a.onAdd=Me(Se.add),a.onError=Me(Se.error),a.onSelect=Me(Se.select),a.reactRootRef=d.a.createRef(),a}return Object(c.a)(t,e),Object(n.a)(t,[{key:"attributeChangedCallback",value:function(e,t,a){if(this.mountPoint&&t!==a){if(!Object.values(Je).includes(e))throw new Error("Untracked changed attribute: ".concat(e));this.render()}}},{key:"connectedCallback",value:function(){var e=this;this.mountPoint=document.createElement("div");var t,a,r=this.attachShadow({mode:"open"});r.appendChild(this.mountPoint),this.jss=Object(y.b)(Ke({},Object(h.a)(),{insertionPoint:this.mountPoint})),this.keycloak=Ke({},_e(),{initialized:!0}),this.unsubscribeFromKeycloakEvent=(t="keycloak",a=function(){e.keycloak=Ke({},_e(),{initialized:!0}),e.render()},window.addEventListener(t,a),function(){window.removeEventListener(t,a)}),this.render(),b()(r)}},{key:"disconnectedCallback",value:function(){this.unsubscribeFromWidgetEvents&&this.unsubscribeFromWidgetEvents(),this.unsubscribeFromKeycloakEvent&&this.unsubscribeFromKeycloakEvent()}},{key:"defaultWidgetEventHandler",value:function(){var e=this;return function(t){var a=function(e){var t=e.type,a=e.detail;return{type:t,payload:a.payload,error:a.error,meta:a.meta}}(t);e.reactRootRef.current.dispatch(a)}}},{key:"render",value:function(){if(!("true"===this.getAttribute(Je.hidden))){var e,t,a=this.getAttribute(Je.locale);if(He(a),"true"===this.getAttribute(Je.disableDefaultEventHandler))this.unsubscribeFromWidgetEvents&&this.unsubscribeFromWidgetEvents(),this.unsubscribeFromKeycloakEvent&&this.unsubscribeFromKeycloakEvent();else{var r=this.defaultWidgetEventHandler();this.unsubscribeFromWidgetEvents=(e=Object.values(De),t=r,e.forEach((function(e){return window.addEventListener(e,t)})),function(){e.forEach((function(e){return window.removeEventListener(e,t)}))})}f.a.render(d.a.createElement(O.Provider,{value:this.keycloak},d.a.createElement(v.b,{jss:this.jss},d.a.createElement(Ue,{ref:this.reactRootRef,onAdd:this.onAdd,onSelect:this.onSelect,onError:this.onError}))),this.mountPoint)}}}],[{key:"observedAttributes",get:function(){return Object.values(Je)}}]),t}(Object(l.a)(HTMLElement));customElements.define("member-table",Ve)},83:function(e){e.exports=JSON.parse('{"common":{"couldNotFetchData":"Unfortunately we could not fetch entity data","notAuthenticated":"User is not authenticated."},"filters":{"value":"Value","addFilter":"Add filter","clearFilters":"Clear filters","filter":"Filter","operator":"Operator","operators":{"equals":"equals","in":"in","specified":"specified","unspecified":"unspecified","contains":"contains"}},"entities":{"member":{"noItems":"No members available","id":"ID","name":"entities.member.name","surname":"entities.member.surname","age":"entities.member.age","error":{"dataLoading":"Error during server connection"}}}}')},96:function(e,t,a){e.exports=a(113)}},[[96,1,2]]]);
//# sourceMappingURL=main.11175047.chunk.js.map